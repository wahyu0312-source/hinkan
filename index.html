<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dashboard</title>
<style>
  :root { --primary:#2563eb; --primary-dark:#1e40af; --bg-body:#f8fafc; --surface:#ffffff; --text-main:#0f172a; --text-muted:#64748b; --border:#e2e8f0; --radius:12px; --shadow:0 4px 6px -1px rgba(0,0,0,0.05); }
  * { box-sizing: border-box; } body { margin:0; font-family:"Helvetica Neue",Arial,sans-serif; background:var(--bg-body); color:var(--text-main); padding-bottom:80px; }
  a { text-decoration:none; color:inherit; transition:.2s; }
  
  header { background:var(--surface); border-bottom:1px solid var(--border); padding:0 20px; height:64px; display:flex; align-items:center; justify-content:space-between; position:sticky; top:0; z-index:50; }
  .brand { font-weight:bold; font-size:1.2rem; color:var(--primary); display:flex; align-items:center; gap:10px; }
  .nav-desktop { display:none; gap:15px; }
  @media(min-width: 900px){ .nav-desktop{display:flex} .burger{display:none} }
  .nav-link { padding:8px 12px; border-radius:6px; font-weight:500; color:var(--text-muted); }
  .nav-link.active, .nav-link:hover { background:#eff6ff; color:var(--primary); }

  .burger { background:none; border:1px solid var(--border); padding:8px; border-radius:8px; cursor:pointer; }
  .drawer { position:fixed; inset:0; z-index:100; display:none; }
  .drawer.open { display:block; }
  .backdrop { position:absolute; inset:0; background:rgba(0,0,0,0.4); }
  .drawer-content { position:absolute; top:0; left:0; bottom:0; width:280px; background:white; padding:25px; transform:translateX(-100%); transition:.3s; }
  .drawer.open .drawer-content { transform:translateX(0); }
  .drawer-link { display:block; padding:12px; font-weight:500; border-radius:8px; margin-bottom:5px; }
  .drawer-link.active { background:#eff6ff; color:var(--primary); }

  .container { max-width:1200px; margin:30px auto; padding:0 20px; }
  .grid { display:grid; gap:20px; }
  .grid-2 { grid-template-columns:1fr; }
  @media(min-width: 768px){ .grid-2{grid-template-columns:1fr 1fr} }
  .grid-3 { grid-template-columns:1fr; }
  @media(min-width: 768px){ .grid-3{grid-template-columns:repeat(3,1fr)} }

  .card { background:var(--surface); padding:24px; border-radius:var(--radius); border:1px solid var(--border); box-shadow:var(--shadow); }
  h2, h3 { margin-top:0; color:var(--text-main); }
  h3 { font-size:1.1rem; border-bottom:2px solid #f1f5f9; padding-bottom:10px; margin-bottom:15px; }

  .hero { background:linear-gradient(135deg, var(--primary), var(--primary-dark)); color:white; }
  .hero h2 { color:white; }
  .stat-row { display:flex; gap:20px; margin-top:15px; }
  .stat-val { font-size:1.5rem; font-weight:800; }
  .stat-lbl { font-size:0.8rem; opacity:0.9; }

  /* Work Log Styles */
  .log-item { display:flex; gap:12px; padding:12px 0; border-bottom:1px dashed #eee; align-items:center; font-size:0.95rem; }
  .log-time { font-family:monospace; color:var(--text-muted); font-size:0.85rem; }
  .log-badge { padding:2px 8px; border-radius:4px; font-size:0.75rem; font-weight:bold; }
  .bg-claim { background:#fee2e2; color:#b91c1c; }
  .bg-check { background:#dcfce7; color:#15803d; }

  /* Admin Toggle */
  .admin-only { display:none; }
</style>
</head>
<body>

<header>
  <div class="brand">
    <button class="burger" id="btnMenu">â˜°</button>
    <span>å“è³ªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </span>
  </div>
  <nav class="nav-desktop">
    <a href="./index.html" class="nav-link active">ğŸ  ãƒ›ãƒ¼ãƒ </a>
    <a href="./forms.html" class="nav-link">ğŸ“„ æˆç¸¾æ›¸</a>
    <a href="./sagyoutejunsho.html" class="nav-link">ğŸ“ æ‰‹é †æ›¸</a>
    <a href="./claim.html" class="nav-link">ğŸ“¢ ã‚¯ãƒ¬ãƒ¼ãƒ </a>
    <a href="./quality.html" class="nav-link">ğŸ” å“è³ªæƒ…å ±</a>
  </nav>
</header>

<div class="drawer" id="drawer">
  <div class="backdrop" id="closeDrawer"></div>
  <div class="drawer-content">
    <h3>ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h3>
    <a href="./index.html" class="drawer-link active">ğŸ  ãƒ›ãƒ¼ãƒ </a>
    <a href="./forms.html" class="drawer-link">ğŸ“„ æˆç¸¾æ›¸</a>
    <a href="./sagyoutejunsho.html" class="drawer-link">ğŸ“ æ‰‹é †æ›¸</a>
    <a href="./claim.html" class="drawer-link">ğŸ“¢ ã‚¯ãƒ¬ãƒ¼ãƒ </a>
    <a href="./quality.html" class="drawer-link">ğŸ” å“è³ªæƒ…å ±</a>
    <hr style="margin:15px 0; border:0; border-top:1px solid #eee;">
    <a href="./admin-prefix.html" class="drawer-link">ğŸ”‘ Admin Prefix</a>
  </div>
</div>

<main class="container">
  <div class="grid grid-2" style="margin-bottom:20px;">
    <!-- Hero Section -->
    <section class="card hero">
      <h2>ğŸ‘‹ ãŠç–²ã‚Œæ§˜ã§ã™</h2>
      <p>æœ¬æ—¥ã®æ¥­å‹™çŠ¶æ³ (Status Hari Ini)</p>
      <div class="stat-row">
        <div><div class="stat-val" id="countToday">0</div><div class="stat-lbl">æœ¬æ—¥ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</div></div>
        <div><div class="stat-val" id="adminState">OFF</div><div class="stat-lbl">ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰</div></div>
      </div>
    </section>

    <!-- Work Log Section (NEW) -->
    <section class="card">
      <h3>ğŸ“… æœ¬æ—¥ã®æ¥­å‹™ãƒ­ã‚° (Today's Activity)</h3>
      <div id="todayList" style="max-height:200px; overflow-y:auto; padding-right:5px;">
        <div style="color:#999; font-size:0.9rem; padding:10px 0;">ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“ (Belum ada aktivitas)</div>
      </div>
    </section>
  </div>

  <div class="grid grid-3">
    <section class="card">
      <h3>ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹</h3>
      <div style="display:grid; gap:10px;">
        <a href="./forms.html" class="nav-link" style="border:1px solid #eee; text-align:center;">ğŸ“„ æˆç¸¾æ›¸æ¤œç´¢</a>
        <a href="./claim.html" class="nav-link" style="border:1px solid #eee; text-align:center;">ğŸ“¢ ã‚¯ãƒ¬ãƒ¼ãƒ å…¥åŠ›</a>
      </div>
    </section>

    <section class="card">
      <h3>ğŸ“ ãƒªãƒ³ã‚¯é›†</h3>
      <div style="display:grid; gap:10px;">
        <a href="https://online.fliphtml5.com/fjppt/mhky/" target="_blank" class="nav-link" style="border:1px solid #eee;">ğŸ“˜ æ¤œæŸ»åŸºæº–æ›¸ (MB-XX)</a>
      </div>
    </section>

    <section class="card">
      <h3>âš™ï¸ ç®¡ç†ãƒ„ãƒ¼ãƒ«</h3>
      <button id="btnToggleAdmin" style="width:100%; padding:10px; cursor:pointer; margin-bottom:10px; background:#fff; border:1px solid #ccc; border-radius:6px;">ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ (Admin Switch)</button>
      <div class="admin-only">
        <a href="./admin-prefix.html" class="nav-link" style="display:block; background:#fff7ed; color:#c2410c; margin-bottom:5px;">ğŸ”‘ Prefix è¨­å®š</a>
        <a href="./admin-serial-gas.html" class="nav-link" style="display:block; background:#fff7ed; color:#c2410c;">â›½ ã‚·ãƒªã‚¢ãƒ«ç®¡ç†</a>
      </div>
    </section>
  </div>
</main>

<script>
  // 1. Mobile Menu
  const $ = s => document.querySelector(s);
  $('#btnMenu').onclick = () => $('#drawer').classList.add('open');
  $('#closeDrawer').onclick = () => $('#drawer').classList.remove('open');

  // 2. Admin Logic
  const ADMIN_KEY = 'kensa_admin';
  function updateAdminUI(){
    const isAdmin = localStorage.getItem(ADMIN_KEY) === '1';
    $('#adminState').textContent = isAdmin ? 'ON' : 'OFF';
    document.querySelectorAll('.admin-only').forEach(el => el.style.display = isAdmin ? 'block' : 'none');
  }
  $('#btnToggleAdmin').onclick = () => {
    if(localStorage.getItem(ADMIN_KEY) === '1'){
      if(confirm('Logout dari Admin?')) localStorage.removeItem(ADMIN_KEY);
    } else {
      if(prompt('Password Admin:') === 'admin2025') localStorage.setItem(ADMIN_KEY, '1');
      else alert('Password Salah');
    }
    updateAdminUI();
  };
  updateAdminUI();

  // 3. Work Log Logic (NEW)
  function renderTodayLogs() {
    const logs = JSON.parse(localStorage.getItem('kensa_work_log') || '[]');
    const todayStr = new Date().toLocaleDateString('ja-JP'); 
    
    // Filter hanya hari ini
    const todayLogs = logs.filter(l => l.date === todayStr);
    
    $('#countToday').textContent = todayLogs.length;
    const listEl = $('#todayList');
    
    if(todayLogs.length > 0) {
      listEl.innerHTML = '';
      // Tampilkan dari yang paling baru (reverse)
      [...todayLogs].reverse().forEach(log => {
        const item = document.createElement('div');
        item.className = 'log-item';
        
        let typeBadge = '';
        if(log.type === 'CLAIM') typeBadge = `<span class="log-badge bg-claim">CLAIM</span>`;
        if(log.type === 'CHECK') typeBadge = `<span class="log-badge bg-check">CHECK</span>`;

        item.innerHTML = `
          <span class="log-time">${log.time}</span>
          ${typeBadge}
          <span style="flex:1; font-weight:500;">${log.title}</span>
        `;
        listEl.appendChild(item);
      });
    }
  }
  renderTodayLogs();
</script>
</body>
</html>
